<div
  *ngIf="actionMessage"
  class="alert alert-dismissible fade show text-center sticky-top"
  [ngClass]="actionMessage.type === 'danger' ? 'alert-danger' : 'alert-success'"
  role="alert"
>
  <strong>{{ actionMessage.message }}</strong>
  <button
    type="button"
    class="btn-close"
    (click)="actionMessage = null"
    aria-label="Close"
  ></button>
</div>

<div class="card shadow-sm h-100 border-0" style="border-radius: 8px; overflow: hidden">
  <div class="position-relative p-3 text-center" style="background-color: #f8f9fa">
    <small class="text-muted position-absolute top-0 start-0 m-2">#{{ pokemon.id }}</small>
    <img
      [src]="pokemon.imagem_url"
      [alt]="pokemon.nome"
      class="card-img-top mx-auto"
      style="height: 120px; width: auto; object-fit: contain"
    />
    <div class="position-absolute top-0 end-0 m-2">
      <span
        *ngFor="let tipo of pokemon.tipos"
        class="badge text-white ms-1"
        [ngClass]="typeMapper.tipoClasses[traduzirTipo(tipo).toLowerCase()] || 'bg-secondary'"
      >
        {{ traduzirTipo(tipo) }}
      </span>
    </div>
  </div>

  <div class="card-body p-3">
    <h5 class="fw-bold text-center mb-3 text-capitalize">{{ pokemon.nome }}</h5>

    <div *ngIf="showStats" class="stats-container">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <small class="text-muted fw-bold me-2" style="width: 50px">HP</small>
        <div class="progress flex-grow-1 me-2" style="height: 8px">
          <div
            class="progress-bar"
            role="progressbar"
            [style.width.%]="(pokemon.hp / 255) * 100"
            style="background-color: #dc3545"
            aria-valuenow="{{ pokemon.hp }}"
            aria-valuemin="0"
            aria-valuemax="255"
          ></div>
        </div>
        <small class="fw-bold" style="width: 25px; text-align: right">{{ pokemon.hp }}</small>
      </div>

      <div class="d-flex justify-content-between align-items-center mb-2">
        <small class="text-muted fw-bold me-2" style="width: 50px">Ataque</small>
        <div class="progress flex-grow-1 me-2" style="height: 8px">
          <div
            class="progress-bar"
            role="progressbar"
            [style.width.%]="(pokemon.ataque / 255) * 100"
            style="background-color: #ffc107"
            aria-valuenow="{{ pokemon.ataque }}"
            aria-valuemin="0"
            aria-valuemax="255"
          ></div>
        </div>
        <small class="fw-bold" style="width: 25px; text-align: right">{{ pokemon.ataque }}</small>
      </div>

      <div class="d-flex justify-content-between align-items-center mb-3">
        <small class="text-muted fw-bold me-2" style="width: 50px">Defesa</small>
        <div class="progress flex-grow-1 me-2" style="height: 8px">
          <div
            class="progress-bar"
            role="progressbar"
            [style.width.%]="(pokemon.defesa / 255) * 100"
            style="background-color: #0d6efd"
            aria-valuenow="{{ pokemon.defesa }}"
            aria-valuemin="0"
            aria-valuemax="255"
          ></div>
        </div>
        <small class="fw-bold" style="width: 25px; text-align: right">{{ pokemon.defesa }}</small>
      </div>
    </div>

    <div class="d-flex justify-content-around mt-3">
      <button
        class="btn btn-sm"
        [ngClass]="pokemon.favorito ? 'btn-warning text-white' : 'btn-outline-warning'"
        (click)="toggleFavorito()"
      >
        {{ pokemon.favorito ? '★ Favorito' : '☆ Favorito' }}
      </button>

      <button
        class="btn btn-sm"
        [ngClass]="pokemon.grupo_batalha ? 'btn-success text-white' : 'btn-outline-success'"
        (click)="toggleGrupo()"
      >
        {{
          pokemon.grupo_batalha ? 'Remover do Grupo de batalha' : 'Adicionar ao Grupo de batalha'
        }}
      </button>
    </div>
  </div>
</div>
